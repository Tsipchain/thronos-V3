<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ğŸ’¼ THR Wallet Viewer</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      padding: 20px;
    }
    nav a {
      color: #0f0;
      margin-right: 1em;
      text-decoration: none;
    }
    input, button {
      background: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 8px;
      margin: 10px 0;
    }
    button { cursor: pointer; }
    .tx {
      margin-top: 20px;
      border-top: 1px dashed #0f0;
      padding-top: 10px;
    }
    .btc-val {
        color: #ff0;
        font-size: 0.9em;
    }
    .lang-toggle {
        position: absolute;
        top: 10px;
        right: 10px;
        background: #222;
        color: #0f0;
        border: 1px solid #0f0;
        padding: 5px 10px;
        cursor: pointer;
    }
    .lang-en { display: none; }
  </style>
</head>
<body>

  <button class="lang-toggle" onclick="toggleLanguage()">GR | EN</button>

  <nav>
    <a href="/">ğŸ  <span class="lang-el">Î‘ÏÏ‡Î¹ÎºÎ®</span><span class="lang-en">Home</span></a>
    <a href="/pledge">ğŸ”¥ <span class="lang-el">Î”Î­ÏƒÎ¼ÎµÏ…ÏƒÎ·</span><span class="lang-en">Pledge</span></a>
    <a href="/viewer">ğŸ“¦ <span class="lang-el">Î•Î¾ÎµÏÎµÏ…Î½Î·Ï„Î®Ï‚</span><span class="lang-en">Viewer</span></a>
    <a href="/send">ğŸ’¸ <span class="lang-el">Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®</span><span class="lang-en">Send</span></a>
    <a href="/wallet">ğŸ‘› <span class="lang-el">Î Î¿ÏÏ„Î¿Ï†ÏŒÎ»Î¹</span><span class="lang-en">Wallet</span></a>
    <a href="/tokenomics">ğŸ“œ <span class="lang-el">Tokenomics</span><span class="lang-en">Tokenomics</span></a>
    <a href="/recovery">ğŸ› ï¸ <span class="lang-el">Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ·</span><span class="lang-en">Recovery</span></a>
    <a href="/whitepaper">ğŸ“„ <span class="lang-el">Whitepaper</span><span class="lang-en">Whitepaper</span></a>
    <a href="/roadmap">ğŸ—ºï¸ <span class="lang-el">Roadmap</span><span class="lang-en">Roadmap</span></a>
  </nav>

  <h1>ğŸ’¼ <span class="lang-el">Î ÏÎ¿Î²Î¿Î»Î® Î Î¿ÏÏ„Î¿Ï†Î¿Î»Î¹Î¿Ï THR</span><span class="lang-en">THR Wallet Viewer</span></h1>
  <p><span class="lang-el">Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Î¼Î¹Î± Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· THR Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï„Î¿ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ ÎºÎ±Î¹ Ï„Î¿ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ ÏƒÏ…Î½Î±Î»Î»Î±Î³ÏÎ½:</span><span class="lang-en">Enter a THR address to view its balance and transaction history:</span></p>

  <div>
    <input type="text" id="thrAddress" placeholder="e.g. THR..." size="40" />
    <button onclick="loadWallet()">ğŸ” <span class="lang-el">Î ÏÎ¿Î²Î¿Î»Î®</span><span class="lang-en">View Wallet</span></button>
  </div>

  <h2>
      <span class="lang-el">Î¥Ï€ÏŒÎ»Î¿Î¹Ï€Î¿:</span><span class="lang-en">Balance:</span> 
      <span id="balance">0</span> THR 
      <span class="btc-val">(â‰ˆ <span id="btcValue">0.0000</span> BTC)</span>
  </h2>
  
  <div id="txHistory"><span class="lang-el">Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ ÏƒÏ…Î½Î±Î»Î»Î±Î³Î­Ï‚.</span><span class="lang-en">No transactions yet.</span></div>

  <script>
    // Language handling
    function toggleLanguage() {
        const currentLang = localStorage.getItem('lang') || 'el';
        const newLang = currentLang === 'el' ? 'en' : 'el';
        setLanguage(newLang);
    }

    function setLanguage(lang) {
        localStorage.setItem('lang', lang);
        const elElements = document.querySelectorAll('.lang-el');
        const enElements = document.querySelectorAll('.lang-en');
        
        if (lang === 'el') {
            elElements.forEach(el => el.style.display = 'inline');
            enElements.forEach(el => el.style.display = 'none');
        } else {
            elElements.forEach(el => el.style.display = 'none');
            enElements.forEach(el => el.style.display = 'inline');
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const savedLang = localStorage.getItem('lang') || 'el';
        setLanguage(savedLang);
    });

    async function loadWallet() {
      const addr = document.getElementById("thrAddress").value.trim();
      if (!addr) {
        alert("Please enter a THR address.");
        return;
      }
      try {
        const res = await fetch(`/wallet_data/${addr}`);
        if (!res.ok) throw new Error("Server returned " + res.status);
        const data = await res.json();
        
        const balance = parseFloat(data.balance);
        document.getElementById("balance").textContent = balance + " THR";
        
        // Calculate BTC value (Fixed rate for now: 1 THR = 0.0001 BTC)
        const btcVal = (balance * 0.0001).toFixed(8);
        document.getElementById("btcValue").textContent = btcVal;

        const div = document.getElementById("txHistory");
        if (!data.transactions.length) {
          div.textContent = "No transactions found.";
        } else {
          let html = "";
          data.transactions.forEach(tx => {
            html += `
            <div class="tx">
              <strong>${tx.timestamp}</strong><br>
              ${tx.from ? `From: ${tx.from}<br>` : ""}
              ${tx.to   ? `To: ${tx.to}<br>`     : ""}
              Amount: ${tx.amount ?? tx.reward ?? 0} ${tx.amount ? "" : "THR"}<br>
              ${tx.fee ? `Fee: ${tx.fee}` : ""}
            </div>`;
          });
          div.innerHTML = html;
        }
      } catch (e) {
        alert("Error loading wallet: " + e.message);
      }
    }
  </script>

</body>
</html>